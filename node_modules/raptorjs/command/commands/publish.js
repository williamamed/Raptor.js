var fs=require('fs'),
	fse=require('fs-extra')
var format= require('./../util/format')

module.exports={
	command:'--publish-resource [componente]',
	description: 'Publica los recursos de un componente',
	placeholder:'publishResource',

	action:function(R,value,arg,look){
		if(look!==true)
			R.lookModules();
		
		if(value===true){
			for (var i in R.bundles) {
				if(fs.existsSync(R.basePath+'/src/'+R.bundles[i].path+'/Resources')){
					try {
						fse.removeSync( R.basePath+'/public/rmodules/'+R.bundles[i].vendor+'/'+i);
						fse.copySync(R.basePath+'/src/'+R.bundles[i].path+'/Resources', R.basePath+'/public/rmodules/'+R.bundles[i].vendor+'/'+i)
					}catch (err) {
						console.log(format.get(err,format.RED))
					}
				}
			};

			console.log(format.get('Los modulos fueron publicados en public/rmodules',format.BLUE))
			return true;
		}else{
			if(R.bundles[value]){
				if(fs.existsSync(R.basePath+'/src/'+R.bundles[i].path+'/Resources')){
					try {
						fse.removeSync( R.basePath+'/public/rmodules/'+R.bundles[value].vendor+'/'+value);
						fse.copySync(R.basePath+'/src/'+R.bundles[value].path+'/Resources', R.basePath+'/public/rmodules/'+R.bundles[value].vendor+'/'+value)
						console.log(format.get('El módulo fue publicado en public/rmodules',format.BLUE))
					}catch (err) {
						console.log(format.get(err,format.RED))
						return false;
					}
				}
			}
			console.log(format.get('No se encontró ningún módulo con el nombre especificado',format.RED))
			return false;
		}
		
	}
}